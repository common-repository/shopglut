<?php
namespace Shopglut;

use Shopglut\layouts\AllLayouts;
use Shopglut\layouts\shopLayout\ShopListTable;
use Shopglut\showcase\AllShowcases;
use Shopglut\showcase\ShowcaseListTable;

class RegisterMenu {

	private $menu_slug = 'shopglut_layouts';

	public function __construct() {
		add_action( 'admin_menu', array( $this, 'shopglutMenuRegister' ) );
		add_action( 'load-toplevel_page_shopglut_layouts', array( $this, 'shopglutLayoutsScreenOptions' ) );
		add_action( 'load-shopglut_page_shopglut_showcase', array( $this, 'shopglutShowcaseScreenOptions' ) );

	}

	public function shopglutMenuRegister() {

		$shopg_menu = new AllLayouts();
		$shopg_showcase_menu = new AllShowcases();

		add_menu_page(
			esc_html__( 'Shopglut', 'shopglut' ),
			esc_html__( 'Shopglut', 'shopglut' ),
			'manage_options',
			$this->menu_slug,
			array( $shopg_menu, 'renderLayoutsPages' ),
			$this->getMenuIcon(),
			55.42
		);

		// Add a submenu item
		add_submenu_page(
			$this->menu_slug,
			esc_html__( 'Shop Layouts', 'shopglut' ),
			esc_html__( 'Shop Layouts', 'shopglut' ),
			'manage_options',
			$this->menu_slug,
			array( $shopg_menu, 'renderLayoutsPages' )
		);

		// Add a submenu item
		add_submenu_page(
			$this->menu_slug,
			esc_html__( 'Product Showcase', 'shopglut' ),
			esc_html__( 'Product Showcase', 'shopglut' ),
			'manage_options',
			'shopglut_showcase',
			array( $shopg_showcase_menu, 'renderCustomMenuPage' )
		);

		// Add a submenu item
		add_submenu_page(
			$this->menu_slug,
			esc_html__( 'Email Customizer', 'shopglut' ),
			esc_html__( 'Email Customizer', 'shopglut' ),
			'manage_options',
			'shopg_email_templates',
			array( $this, 'renderEmailCustomizer' )
		);

	}

	private function getMenuIcon() {

		return 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjUiIHpvb21BbmRQYW49Im1hZ25pZnkiIHZpZXdCb3g9IjAgMCA0OC43NSA0OC43NDk5OTgiIGhlaWdodD0iNjUiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIG1lZXQiIHZlcnNpb249IjEuMCI+PGRlZnM+PGNsaXBQYXRoIGlkPSJiNzdkYjQ2NjNhIj48cGF0aCBkPSJNIDkgNyBMIDQ3LjgwNDY4OCA3IEwgNDcuODA0Njg4IDMzIEwgOSAzMyBaIE0gOSA3ICIgY2xpcC1ydWxlPSJub256ZXJvIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9ImU2MzU5MGVjZTEiPjxwYXRoIGQ9Ik0gOCAxOCBMIDQ3IDE4IEwgNDcgNDYuNjUyMzQ0IEwgOCA0Ni42NTIzNDQgWiBNIDggMTggIiBjbGlwLXJ1bGU9Im5vbnplcm8iLz48L2NsaXBQYXRoPjwvZGVmcz48cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNIDI1LjMwMDc4MSA4LjM0Mzc1IEMgMjcuMjk2ODc1IDguMzM5ODQ0IDI5LjI1IDguNjM2NzE5IDMxLjE2MDE1NiA5LjIyNjU2MiBDIDMzLjA2NjQwNiA5LjgyMDMxMiAzNC44NDM3NSAxMC42ODM1OTQgMzYuNDg4MjgxIDExLjgxNjQwNiBMIDM5LjkwMjM0NCA4Ljk3NjU2MiBDIDM4Ljg4MjgxMiA4LjEyNSAzNy43OTI5NjkgNy4zNzEwOTQgMzYuNjM2NzE5IDYuNzE0ODQ0IEMgMzUuNDgwNDY5IDYuMDU4NTk0IDM0LjI3NzM0NCA1LjUwNzgxMiAzMy4wMjM0MzggNS4wNjY0MDYgQyAzMS43Njk1MzEgNC42MjEwOTQgMzAuNDg0Mzc1IDQuMjk2ODc1IDI5LjE3NTc4MSA0LjA4MjAzMSBDIDI3Ljg2MzI4MSAzLjg2NzE4OCAyNi41MzkwNjIgMy43NzM0MzggMjUuMjEwOTM4IDMuNzk2ODc1IEMgMjMuODgyODEyIDMuODIwMzEyIDIyLjU2NjQwNiAzLjk1NzAzMSAyMS4yNjE3MTkgNC4yMTQ4NDQgQyAxOS45NTcwMzEgNC40NzI2NTYgMTguNjgzNTk0IDQuODQzNzUgMTcuNDQ1MzEyIDUuMzI4MTI1IEMgMTYuMjEwOTM4IDUuODEyNSAxNS4wMjM0MzggNi40MDIzNDQgMTMuODkwNjI1IDcuMTAxNTYyIEMgMTIuNzU3ODEyIDcuNzk2ODc1IDExLjY5NTMxMiA4LjU4NTkzOCAxMC43MDMxMjUgOS40NzI2NTYgQyA5LjcxMDkzOCAxMC4zNTkzNzUgOC44MDg1OTQgMTEuMzI0MjE5IDcuOTg4MjgxIDEyLjM3MTA5NCBDIDcuMTY3OTY5IDEzLjQxNzk2OSA2LjQ0OTIxOSAxNC41MzEyNSA1LjgyODEyNSAxNS43MDcwMzEgQyA1LjIwNzAzMSAxNi44ODI4MTIgNC42OTUzMTIgMTguMTAxNTYyIDQuMjkyOTY5IDE5LjM3MTA5NCBDIDMuODkwNjI1IDIwLjYzNjcxOSAzLjYwMTU2MiAyMS45Mjk2ODggMy40Mjk2ODggMjMuMjUgQyAzLjI1NzgxMiAyNC41NjY0MDYgMy4yMDMxMjUgMjUuODkwNjI1IDMuMjY5NTMxIDI3LjIxODc1IEMgMy4zMzIwMzEgMjguNTQ2ODc1IDMuNTExNzE5IDI5Ljg1OTM3NSAzLjgxMjUgMzEuMTUyMzQ0IEMgNC4xMDkzNzUgMzIuNDQ5MjE5IDQuNTE5NTMxIDMzLjcwNzAzMSA1LjA0Mjk2OSAzNC45Mjk2ODggQyA1LjU2NjQwNiAzNi4xNTIzNDQgNi4xOTE0MDYgMzcuMzIwMzEyIDYuOTI1NzgxIDM4LjQyOTY4OCBMIDguNDM3NSAzOC40Mjk2ODggQyA3LjUyMzQzOCAzNi45Mjk2ODggNi44MjAzMTIgMzUuMzM5ODQ0IDYuMzI4MTI1IDMzLjY1MjM0NCBDIDUuODM1OTM4IDMxLjk2ODc1IDUuNTc0MjE5IDMwLjI0NjA5NCA1LjU0Mjk2OSAyOC40OTIxODggQyA1LjUxMTcxOSAyNi43MzQzNzUgNS43MDcwMzEgMjUuMDA3ODEyIDYuMTM2NzE5IDIzLjMwNDY4OCBDIDYuNTYyNSAyMS42MDE1NjIgNy4yMDcwMzEgMTkuOTg0Mzc1IDguMDY2NDA2IDE4LjQ1MzEyNSBDIDguOTIxODc1IDE2LjkyMTg3NSA5Ljk2ODc1IDE1LjUyNzM0NCAxMS4xOTUzMTIgMTQuMjczNDM4IEMgMTIuNDI1NzgxIDEzLjAxOTUzMSAxMy43OTY4NzUgMTEuOTQ5MjE5IDE1LjMxMjUgMTEuMDYyNSBDIDE2LjgyODEyNSAxMC4xNzE4NzUgMTguNDMzNTk0IDkuNSAyMC4xMjUgOS4wMzkwNjIgQyAyMS44MjAzMTIgOC41NzgxMjUgMjMuNTQ2ODc1IDguMzQzNzUgMjUuMzAwNzgxIDguMzQzNzUgWiBNIDI1LjMwMDc4MSA4LjM0Mzc1ICIgZmlsbC1vcGFjaXR5PSIxIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48ZyBjbGlwLXBhdGg9InVybCgjYjc3ZGI0NjYzYSkiPjxwYXRoIGZpbGw9IiNmZmZmZmYiIGQ9Ik0gOS42Njc5NjkgMTguOTYwOTM4IEwgMjEuOTEwMTU2IDE4Ljk2MDkzOCBMIDI2LjE1MjM0NCAyMy4wMDc4MTIgTCA0NC42MTMyODEgNy42MDkzNzUgTCA0Ny42Njc5NjkgNy40MTAxNTYgTCAyNi4wNDY4NzUgMzEuNzg5MDYyIEMgMjUuOTI5Njg4IDMxLjkxNzk2OSAyNS43OTI5NjkgMzIuMDIzNDM4IDI1LjYzMjgxMiAzMi4xMDE1NjIgQyAyNS40NzY1NjIgMzIuMTc1NzgxIDI1LjMwODU5NCAzMi4yMTg3NSAyNS4xMzI4MTIgMzIuMjMwNDY5IEMgMjQuOTU3MDMxIDMyLjI0MjE4OCAyNC43ODkwNjIgMzIuMjE4NzUgMjQuNjIxMDk0IDMyLjE2MDE1NiBDIDI0LjQ1NzAzMSAzMi4xMDE1NjIgMjQuMzA4NTk0IDMyLjAxNTYyNSAyNC4xNzU3ODEgMzEuODk4NDM4IFogTSA5LjY2Nzk2OSAxOC45NjA5MzggIiBmaWxsLW9wYWNpdHk9IjEiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvZz48ZyBjbGlwLXBhdGg9InVybCgjZTYzNTkwZWNlMSkiPjxwYXRoIGZpbGw9IiNmZmZmZmYiIGQ9Ik0gNDUuNTcwMzEyIDE4LjI3NzM0NCBMIDQxLjg3MTA5NCAxOC4yNzczNDQgQyA0MS41NjI1IDE4LjI4MTI1IDQxLjI4NTE1NiAxOC4zNzUgNDEuMDM5MDYyIDE4LjU1ODU5NCBDIDQwLjc5Njg3NSAxOC43NDYwOTQgNDAuNjI4OTA2IDE4Ljk4ODI4MSA0MC41NDY4NzUgMTkuMjg1MTU2IEwgMzkuMTYwMTU2IDI0LjE5MTQwNiBMIDM1LjQ1NzAzMSAyNC4xOTE0MDYgTCAyNi41MDc4MTIgMzQuMzgyODEyIEMgMjYuMzU5Mzc1IDM0LjU0Njg3NSAyNi4xODc1IDM0LjY3OTY4OCAyNS45ODgyODEgMzQuNzc3MzQ0IEMgMjUuNzg5MDYyIDM0Ljg3NSAyNS41NzgxMjUgMzQuOTMzNTk0IDI1LjM1NTQ2OSAzNC45NDUzMTIgQyAyNS4xMzI4MTIgMzQuOTYwOTM4IDI0LjkxNzk2OSAzNC45Mjk2ODggMjQuNzA3MDMxIDM0Ljg1OTM3NSBDIDI0LjUgMzQuNzg5MDYyIDI0LjMwODU5NCAzNC42NzU3ODEgMjQuMTQ0NTMxIDM0LjUzMTI1IEwgMTIuNDg0Mzc1IDI0LjE5MTQwNiBMIDkuMDU0Njg4IDI0LjE5MTQwNiBDIDguOTQxNDA2IDI0LjE5MTQwNiA4LjgzNTkzOCAyNC4yMTg3NSA4LjczODI4MSAyNC4yNjk1MzEgQyA4LjY0MDYyNSAyNC4zMjAzMTIgOC41NTg1OTQgMjQuMzkwNjI1IDguNDk2MDk0IDI0LjQ4MDQ2OSBDIDguNDMzNTk0IDI0LjU3MDMxMiA4LjM5MDYyNSAyNC42NzE4NzUgOC4zNzUgMjQuNzgxMjUgQyA4LjM2MzI4MSAyNC44OTA2MjUgOC4zNzEwOTQgMjUgOC40MTAxNTYgMjUuMTAxNTYyIEwgMTIuOTQ1MzEyIDM4LjAzNTE1NiBDIDEyLjk5MjE4OCAzOC4xNzU3ODEgMTMuMDc4MTI1IDM4LjI4OTA2MiAxMy4xOTUzMTIgMzguMzcxMDk0IEMgMTMuMzE2NDA2IDM4LjQ1NzAzMSAxMy40NTMxMjUgMzguNDk2MDk0IDEzLjU5NzY1NiAzOC40OTYwOTQgTCAzMy43NzczNDQgMzguNDk2MDk0IEMgMzMuOTU3MDMxIDM4LjQ5NjA5NCAzNC4xMjg5MDYgMzguNTI3MzQ0IDM0LjI5Mjk2OSAzOC41OTc2NTYgQyAzNC40NTcwMzEgMzguNjY0MDYyIDM0LjYwNTQ2OSAzOC43NjE3MTkgMzQuNzMwNDY5IDM4Ljg5MDYyNSBDIDM0Ljg1NTQ2OSAzOS4wMTU2MjUgMzQuOTUzMTI1IDM5LjE2MDE1NiAzNS4wMTk1MzEgMzkuMzI0MjE5IEMgMzUuMDg5ODQ0IDM5LjQ4ODI4MSAzNS4xMjUgMzkuNjYwMTU2IDM1LjEyNSAzOS44Mzk4NDQgQyAzNS4xMjUgNDAuMDE5NTMxIDM1LjA4OTg0NCA0MC4xOTE0MDYgMzUuMDE5NTMxIDQwLjM1NTQ2OSBDIDM0Ljk1MzEyNSA0MC41MTk1MzEgMzQuODU1NDY5IDQwLjY2NDA2MiAzNC43MzA0NjkgNDAuNzg5MDYyIEMgMzQuNjA1NDY5IDQwLjkxNzk2OSAzNC40NTcwMzEgNDEuMDE1NjI1IDM0LjI5Mjk2OSA0MS4wODIwMzEgQyAzNC4xMjg5MDYgNDEuMTUyMzQ0IDMzLjk1NzAzMSA0MS4xODM1OTQgMzMuNzc3MzQ0IDQxLjE4MzU5NCBMIDE1LjcyNjU2MiA0MS4xODM1OTQgQyAxNS41MzEyNSA0MS4xNzU3ODEgMTUuMzQzNzUgNDEuMjA3MDMxIDE1LjE2NDA2MiA0MS4yNzczNDQgQyAxNC45ODA0NjkgNDEuMzQ3NjU2IDE0LjgyMDMxMiA0MS40NDkyMTkgMTQuNjc5Njg4IDQxLjU4MjAzMSBDIDE0LjUzOTA2MiA0MS43MTg3NSAxNC40Mjk2ODggNDEuODc1IDE0LjM1NTQ2OSA0Mi4wNTQ2ODggQyAxNC4yNzczNDQgNDIuMjM0Mzc1IDE0LjIzODI4MSA0Mi40MjE4NzUgMTQuMjM4MjgxIDQyLjYxNzE4OCBDIDE0LjIzODI4MSA0Mi44MTI1IDE0LjI3NzM0NCA0Mi45OTYwOTQgMTQuMzU1NDY5IDQzLjE3NTc4MSBDIDE0LjQyOTY4OCA0My4zNTU0NjkgMTQuNTM5MDYyIDQzLjUxMTcxOSAxNC42Nzk2ODggNDMuNjQ4NDM4IEMgMTQuODIwMzEyIDQzLjc4NTE1NiAxNC45ODA0NjkgNDMuODg2NzE5IDE1LjE2NDA2MiA0My45NTMxMjUgQyAxNS4zNDM3NSA0NC4wMjM0MzggMTUuNTMxMjUgNDQuMDU0Njg4IDE1LjcyNjU2MiA0NC4wNDY4NzUgTCAxNy44Mzk4NDQgNDQuMDQ2ODc1IEMgMTcuODI4MTI1IDQ0LjE0NDUzMSAxNy44MjAzMTIgNDQuMjQ2MDk0IDE3LjgyMDMxMiA0NC4zNDM3NSBDIDE3LjgyMDMxMiA0NC42Mjg5MDYgMTcuODc1IDQ0LjkwNjI1IDE3Ljk4NDM3NSA0NS4xNzE4NzUgQyAxOC4wOTM3NSA0NS40Mzc1IDE4LjI1IDQ1LjY2Nzk2OSAxOC40NDkyMTkgNDUuODcxMDk0IEMgMTguNjUyMzQ0IDQ2LjA3NDIxOSAxOC44ODY3MTkgNDYuMjMwNDY5IDE5LjE1MjM0NCA0Ni4zMzk4NDQgQyAxOS40MTc5NjkgNDYuNDQ5MjE5IDE5LjY5MTQwNiA0Ni41MDM5MDYgMTkuOTc2NTYyIDQ2LjUwMzkwNiBDIDIwLjI2NTYyNSA0Ni41MDM5MDYgMjAuNTM5MDYyIDQ2LjQ0OTIxOSAyMC44MDQ2ODggNDYuMzM5ODQ0IEMgMjEuMDcwMzEyIDQ2LjIzMDQ2OSAyMS4zMDQ2ODggNDYuMDc0MjE5IDIxLjUwMzkwNiA0NS44NzEwOTQgQyAyMS43MDcwMzEgNDUuNjY3OTY5IDIxLjg2MzI4MSA0NS40Mzc1IDIxLjk3MjY1NiA0NS4xNzE4NzUgQyAyMi4wODIwMzEgNDQuOTA2MjUgMjIuMTM2NzE5IDQ0LjYyODkwNiAyMi4xMzY3MTkgNDQuMzQzNzUgQyAyMi4xMzY3MTkgNDQuMjQ2MDk0IDIyLjEyODkwNiA0NC4xNDQ1MzEgMjIuMTE3MTg4IDQ0LjA0Njg3NSBMIDI4Ljg5ODQzOCA0NC4wNDY4NzUgQyAyOC44ODI4MTIgNDQuMTQ0NTMxIDI4Ljg3NSA0NC4yNDYwOTQgMjguODc1IDQ0LjM0Mzc1IEMgMjguODc1IDQ0LjYyODkwNiAyOC45Mjk2ODggNDQuOTA2MjUgMjkuMDM5MDYyIDQ1LjE3MTg3NSBDIDI5LjE0ODQzOCA0NS40MzM1OTQgMjkuMzA0Njg4IDQ1LjY2Nzk2OSAyOS41MDc4MTIgNDUuODcxMDk0IEMgMjkuNzEwOTM4IDQ2LjA3NDIxOSAyOS45NDUzMTIgNDYuMjMwNDY5IDMwLjIwNzAzMSA0Ni4zMzk4NDQgQyAzMC40NzI2NTYgNDYuNDQ5MjE5IDMwLjc1IDQ2LjUwMzkwNiAzMS4wMzUxNTYgNDYuNTAzOTA2IEMgMzEuMzIwMzEyIDQ2LjUwMzkwNiAzMS41OTc2NTYgNDYuNDQ5MjE5IDMxLjg1OTM3NSA0Ni4zMzk4NDQgQyAzMi4xMjUgNDYuMjMwNDY5IDMyLjM1OTM3NSA0Ni4wNzQyMTkgMzIuNTYyNSA0NS44NzEwOTQgQyAzMi43NjU2MjUgNDUuNjY3OTY5IDMyLjkxNzk2OSA0NS40MzM1OTQgMzMuMDI3MzQ0IDQ1LjE3MTg3NSBDIDMzLjE0MDYyNSA0NC45MDYyNSAzMy4xOTUzMTIgNDQuNjI4OTA2IDMzLjE5NTMxMiA0NC4zNDM3NSBDIDMzLjE5MTQwNiA0NC4yNDYwOTQgMzMuMTgzNTk0IDQ0LjE0NDUzMSAzMy4xNjc5NjkgNDQuMDQ2ODc1IEwgMzQuNzUgNDQuMDQ2ODc1IEMgMzUuMjQ2MDk0IDQ0LjA0Njg3NSAzNS42OTE0MDYgNDMuODk4NDM4IDM2LjA4NTkzOCA0My41OTc2NTYgQyAzNi40ODQzNzUgNDMuMzAwNzgxIDM2Ljc1IDQyLjkxNDA2MiAzNi44ODI4MTIgNDIuNDM3NSBMIDQyLjkxMDE1NiAyMS4wMzkwNjIgTCA0NS42MTcxODggMjEuMDM5MDYyIEMgNDUuODA0Njg4IDIxLjAzOTA2MiA0NS45ODQzNzUgMjEuMDAzOTA2IDQ2LjE1NjI1IDIwLjkyOTY4OCBDIDQ2LjMyODEyNSAyMC44NTkzNzUgNDYuNDgwNDY5IDIwLjc1MzkwNiA0Ni42MDkzNzUgMjAuNjIxMDk0IEMgNDYuNzQyMTg4IDIwLjQ4ODI4MSA0Ni44Mzk4NDQgMjAuMzMyMDMxIDQ2LjkwNjI1IDIwLjE1NjI1IEMgNDYuOTc2NTYyIDE5Ljk4NDM3NSA0Ny4wMDc4MTIgMTkuODA0Njg4IDQ3IDE5LjYxNzE4OCBDIDQ2Ljk4ODI4MSAxOS40MzM1OTQgNDYuOTQ1MzEyIDE5LjI2MTcxOSA0Ni44NjcxODggMTkuMDkzNzUgQyA0Ni43ODkwNjIgMTguOTI5Njg4IDQ2LjY4NzUgMTguNzg1MTU2IDQ2LjU1MDc4MSAxOC42NjAxNTYgQyA0Ni40MTc5NjkgMTguNTM1MTU2IDQ2LjI2NTYyNSAxOC40NDE0MDYgNDYuMDk3NjU2IDE4LjM3NSBDIDQ1LjkyNTc4MSAxOC4zMDg1OTQgNDUuNzUgMTguMjc3MzQ0IDQ1LjU3MDMxMiAxOC4yNzczNDQgWiBNIDQ1LjU3MDMxMiAxOC4yNzczNDQgIiBmaWxsLW9wYWNpdHk9IjEiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvZz48L3N2Zz4=';
	}

	public function shopglutshowcaseScreenoptions() {
		$current_screen = get_current_screen();

		if ( 'shopglut_page_shopglut_showcase' === $current_screen->id && ! wp_verify_nonce( isset( $_POST['menu_nonce_check'] ), 'menu_nonce_check' ) &&
			isset( $_GET['layout_id'] )
		) {

			return;
		}

		$args = array(
			'label' => esc_html__( 'Items per page', 'shopglut' ),
			'default' => 10,
			'option' => 'shopglut_showcase_per_page',
		);
		add_screen_option( 'per_page', $args );

		$showcaselist = new ShowcaseListTable();
	}

	public function renderEmailCustomizer() {
		echo '<h2 style="padding-left:25px">Not added yet, We shall try to add soon...</h2>';
	}

	public function shopglutLayoutsScreenOptions() {
		$current_screen = get_current_screen();

		if ( 'formglut-pro_page_shopglut_layouts' === $current_screen->id && ! wp_verify_nonce( isset( $_POST['menu_nonce_check'] ), 'menu_nonce_check' ) &&
			isset( $_GET['layout_id'] )
		) {

			return;
		}

		$args = array(
			'label' => esc_html__( 'Items per page', 'shopglut' ),
			'default' => 10,
			'option' => 'shopglut_layouts_per_page',
		);
		add_screen_option( 'per_page', $args );

		$layoutlist = new ShopListTable();
	}

	public static function get_instance() {
		static $instance;

		if ( is_null( $instance ) ) {
			$instance = new self();
		}
		return $instance;
	}
}